// SPDX-License-Identifier: (GPL-2.0+ OR MIT)
/*
 * Copyright (c) 2019 Amlogic, Inc. All rights reserved.
 */

/dts-v1/;

#include "mesont3x.dtsi"
#include "partition_mbox_ab.dtsi"
#include "mesont3x_drm.dtsi"
#include "mesont3x_bc302_linux-panel.dtsi"
#include <dt-bindings/input/input.h>

/ {
	model = "Amlogic";
	amlogic-dt-id = "t3x_t968d4_bc302";
	compatible = "amlogic, t3x";
	interrupt-parent = <&gic>;
	#address-cells = <2>;
	#size-cells = <2>;

	aliases {
		serial0 = &uart_B;
		serial1 = &uart_A;
		serial2 = &uart_C;
		serial3 = &uart_D;
		i2c0 = &i2c0;
		i2c1 = &i2c1;
		i2c2 = &i2c2;
		i2c3 = &i2c3;
		i2c4 = &i2c4;
		spi0 = &spifc;
		spi1 = &spicc0;
		spi2 = &spicc1;
		spi3 = &spicc2;
		spi4 = &spicc3;
		spi5 = &spicc4;
		spi6 = &spicc5;
		tsensor0 = &cpu_tsensor;
		tsensor1 = &gpu_tsensor;
		tsensor2 = &vpu_tsensor;
		tsensor3 = &dos_tsensor;
		tsensor4 = &nna_tsensor;
	};

	memory@00000000 {
		device_type = "memory";
		linux,usable-memory = <0x00000000 0x00000000 0x00000000 0xE0000000
					0x00000001 0x00000000 0x00000000 0x20000000>;
	};

	reserved-memory {
		#address-cells = <2>;
		#size-cells = <2>;
		ranges;

		/* global autoconfigured region for contiguous allocations */

		ramdump_bl33z@00000000 {
			reg = <0x0 0x0 0x0 0x1800000>; /* 0 ~ 24M */
			status = "disabled";
		};

		ramoops@0x08400000 {
			compatible = "ramoops";
			reg = <0x0 0x08400000 0x0 0x00100000>;
			record-size = <0x20000>;
			console-size = <0x40000>;
			ftrace-size = <0x80000>;
			pmsg-size = <0x10000>;
			bconsole-size = <0x10000>;
			status = "disabled";
		};

		secmon_reserved:linux,secmon {
			compatible = "shared-dma-pool";
			/*reusable;*/
			no-map;
			size = <0x0 0x400000>;
			alignment = <0x0 0x400000>;
			reg = <0x0 0x05000000 0x0 0x3400000>;
		};

		dsp_fw_reserved:linux,dsp_fw {
			compatible = "shared-dma-pool";
			reusable;
			size = <0x0 0x1000000>;
			//size = <0x0 0x0>;
			alignment = <0x0 0x400000>;
			alloc-ranges = <0x0 0x3f000000 0x0 0x1000000>;
		};

		/*dsp_shm_reserved:linux,dsp_shm {      */
		/*	compatible = "dspshmem";            */
		/*	reg = <0x0 0x40820000 0x0 0x80000>; */
		/*	size = <0x80000>;                   */
		/*};*/

		logo_reserved:linux,meson-fb {
			compatible = "amlogic, meson-fb";
			size = <0x0 0x800000>;
			alignment = <0x0 0x400000>;
			reg = <0x0 0x3e800000 0x0 0x800000>;
		};

		codec_mm_cma:linux,codec_mm_cma {
			compatible = "shared-dma-pool";
			reusable;
			/* ion_codec_mm max can alloc size 80M*/
			size = <0x0 0x1b000000>;
			alignment = <0x0 0x400000>;
			alloc-ranges = <0x0 0x0 0x0 0xe0000000>;
			linux,contiguous-region;
			clear-map;
		};

		/*di CMA pool */
		di_cma_reserved:linux,di_cma {
			compatible = "shared-dma-pool";
			reusable;
			/* buffer_size = 3621952(yuv422 8bit)
			 *  | 4736064(yuv422 10bit)
			 *  | 4074560(yuv422 10bit full pack mode)
			 * 10x3621952=34.6M(0x23) support 8bit
			 * 10x4736064=45.2M(0x2e) support 12bit
			 * 10x4074560=40M(0x28) support 10bit
			 */
			size = <0x0 0x0>;
			//size = <0x0 0x400000>;
			//size = <0x0 0x0>;
			alignment = <0x0 0x400000>;
		};

		/*  POST PROCESS MANAGER */
		ppmgr_reserved:linux,ppmgr {
			compatible = "shared-dma-pool";
			size = <0x0 0x0>;
		};

		camera_cma_reserved:linux,camera_cma {
			compatible = "shared-dma-pool";
			reusable;
			size = <0x0 0x0>;
			//size = <0x0 0xB000000>;
			alignment = <0x0 0x400000>;
		};

		ion_cma_reserved:linux,ion-dev {
			compatible = "shared-dma-pool";
			reusable;
			//size = <0x0 0x0>;
			size = <0x0 0x5000000>;
			alignment = <0x0 0x400000>;
		};

		ion_fb_reserved:linux,ion-fb {
			compatible = "shared-dma-pool";
			reusable;
			/* 3840x2160x4x4 round up 4M align */
			//size = <0x0 0x0>;
			size = <0x0 0x8400000>;
			alignment = <0x0 0x400000>;
			alloc-ranges = <0x0 0x0 0x0 0xe0000000>;
		};
		/* secure ion for gpu,advice size is 0x1c800000 */
		ion_secure_reserved:linux,ion-secure {
			compatible = "amlogic, ion-secure-mem";
			no-map;
			size = <0x0 0x0>;
			alignment = <0x0 0x400000>;
		};

		lcd_tcon_reserved:linux,lcd_tcon {
			compatible = "amlogic, lcd_tcon";
			reg = <0x0 0x5e800000 0x0 0x00c00000>;
			no-map;
		};

		/* codec shared reserved */
		codec_mm_reserved:linux,codec_mm_reserved {
			compatible = "amlogic, codec-mm-reserved";
			size = <0x0 0x0>;
			alignment = <0x0 0x100000>;
			//no-map;
		};

		dmaheap_cma_reserved:heap-gfx {
			compatible = "shared-dma-pool";
			reusable;
			size = <0x0 0x10000000>;
			alignment = <0x0 0x400000>;
		};

		dmaheap_fb_reserved:heap-fb {
			compatible = "shared-dma-pool";
			/* 1920x1080x4x6 round up 4M align */
			size = <0x0 0x3400000>;
			alignment = <0x0 0x400000>;
			//alloc-ranges = <0x0 0x20000000 0x0 0x03400000>;
		};

		/*  vdin0 CMA pool */
		/*  vdin0 CMA pool */
		/*vdin0_cma_reserved:linux,vdin0_cma {*/
		/*	compatible = "shared-dma-pool";*/
		/*	reusable;*/
			/* up to 1920x1080 yuv422 8bit and 5 buffers
			 * 1920x1080x2x5 = 20 M
			 */
		/*	size = <0x0 0x01400000>;*/
		/*	alignment = <0x0 0x400000>;*/
		/*};*/
		/*  vdin1 CMA pool */
		vdin1_cma_reserved:linux,vdin1_cma {
			compatible = "shared-dma-pool";
			reusable;
			/* up to 1920x1080 yuv422 8bit and 5 buffers
			 * 1920x1080x2x5 = 20 M
			 */
			//size = <0x0 0x0>;
			size = <0x0 0x01400000>;
			alignment = <0x0 0x400000>;
			alloc-ranges = <0x0 0x0 0x0 0xe0000000>;
		};

		mfh_fw_reserved:linux,mfh_fw {
			compatible = "amlogic, aml_mfh_reserve_mem";
			reusable;
			size = <0x0 0x0>;
			//size = <0x0 0x80000>;
			alignment = <0x0 0x80000>;
			alloc-ranges = <0x0 0x41000000 0x0 0x80000>;
		};

		pcie_dma_ops_mm:linux,pcie_dma_ops {
			compatible = "shared-dma-pool";
			reusable;
			status = "disabled";
			size = <0x0 0x5000000>;
			alignment = <0x0 0x400000>;
			alloc-ranges = <0x0 0x0 0x0 0xe0000000>;
		};

		frc_cma_reserved:linux,frc_cma {
			compatible = "shared-dma-pool";
			reusable;
			/* frc:size need 4M alignment
			 * 1080P 16 buffer:88Mhz (0x5800000)
			 * 4k 16 buffer:348Mhz (0x15c00000)
			 * 400Mhz (0x19000000)
			 * 384Mhz (0x18000000)
			 * 368Mhz (0x17000000)
			 */
			size = <0x0 0xd400000>; // reserved 212M
			alignment = <0x0 0x400000>;
			linux,contiguous-region;
			/*alloc-ranges = <0x0 0x0 0x0 0x3f800000>;*/
		};
	};

	smmu: aml_smmu {
		compatible = "amlogic,smmu";
		status = "disabled";
		#iommu-cells = <1>;
		memory-region = <&pcie_dma_ops_mm>;
	};

	codec_mm {
		compatible = "amlogic, codec, mm";
		memory-region = <&codec_mm_cma &codec_mm_reserved>;
		dev_name = "codec_mm";
		status = "okay";
	};

	cvbsout {
		compatible = "amlogic, cvbsout-sc2";
		status = "disabled";

		/* clk path */
		/* 0:vid_pll vid2_clk */
		/* 1:gp0_pll vid2_clk */
		/* 2:vid_pll vid1_clk */
		/* 3:gp0_pll vid1_clk */
		clk_path = <0>;

		/* performance: reg_address, reg_value */
		/* tm2 */
		performance = <0x1bf0  0x9
			0x1b56  0x333
			0x1b12  0x8080
			0x1b05  0xfd
			0x1c59  0xf850
			0xffff  0x0>; /* ending flag */
		performance_sarft = <0x1bf0  0x9
			0x1b56  0x333
			0x1b12  0x0
			0x1b05  0x9
			0x1c59  0xfc48
			0xffff  0x0>; /* ending flag */
		performance_revB_telecom = <0x1bf0  0x9
			0x1b56  0x546
			0x1b12  0x8080
			0x1b05  0x9
			0x1c59  0xf850
			0xffff  0x0>; /* ending flag */
	};

	multi-di {
		//status = "okay";
		/***************************************************
		 * memory: default is 4
		 *	0:use reserved;
		 *	1:use cma;
		 *	2:use cma as reserved
		 *  4:use codec mem
		 ***************************************************/
		//flag_cma = <4>;//t5d unsupport 4K,di 1CH need 42M
		//memory-region = <&di_cma_reserved>;
		/***************************************************
		 * clock-range: <min max>
		 *	default: <334 334>
		 ***************************************************/
		//clock-range = <334 334>;
		/***************************************************
		 * en_4k: t5d not support 4k
		 ***************************************************/
		en_4k = <0>;
		keep_dec_vf = <2>;
		po_fmt = <0>;
		/***************************************************
		 * post_nub: default is 11 (T7/T3/SC2/S4 new path)
		 * local 7*4075520 = 28
		 * post 11*5222400 = 56
		 ***************************************************/
		post_nub = <11>;
		/***************************************************
		 * 0:not support
		 * bit 0: for 4k
		 * bit 1: for 1080p
		 ***************************************************/
		alloc_sct = <0>;
		/***************************************************
		 * hf: default is 0 (T7/T3/SC2/S4 new path)
		 * 0:not enable;
		 * 1: enable
		 ***************************************************/
		//hf = <1>;
		tb = <2>;
	};

	provisionkey {
		compatible = "amlogic, provisionkey";
		status = "disabled";
		key-permit-default = "write";
		//new key not need add dts if started with KEY_PROVISION_
		KEY_PROVISION_XXX { };
		//test_my_added_keyname { };
	};//End provisionkey

	unifykey{
		compatible = "amlogic,unifykey";
		status = "okay";
		unifykey-num = <19>;
		unifykey-index-0 = <&keysn_0>;
		unifykey-index-1 = <&keysn_1>;
		unifykey-index-2 = <&keysn_2>;
		unifykey-index-3 = <&keysn_3>;
		unifykey-index-4 = <&keysn_4>;
		unifykey-index-5 = <&keysn_5>;
		unifykey-index-6 = <&keysn_6>;
		unifykey-index-7 = <&keysn_7>;
		unifykey-index-8 = <&keysn_8>;
		unifykey-index-9 = <&keysn_9>;
		unifykey-index-10= <&keysn_10>;
		unifykey-index-11= <&keysn_11>;
		unifykey-index-12= <&keysn_12>;
		unifykey-index-13= <&keysn_13>;
		unifykey-index-14= <&keysn_14>;
		unifykey-index-15= <&keysn_15>;
		unifykey-index-16= <&keysn_16>;
		unifykey-index-17= <&keysn_17>;
		unifykey-index-18= <&keysn_18>;
		unifykey-index-19= <&keysn_19>;
		unifykey-index-20= <&keysn_20>;
		unifykey-index-21= <&keysn_21>;

		keysn_0: key_0{
			key-name = "usid";
			key-device = "normal";
			key-permit = "read","write","del";
		};
		keysn_1:key_1{
			key-name = "mac";
			key-device = "normal";
			key-permit = "read","write","del";
		};
		keysn_2:key_2{
			key-name = "hdcp";
			key-device = "secure";
			key-type = "sha1";
			key-permit = "read","write","del";
		};
		keysn_3:key_3{
			key-name = "secure_boot_set";
			key-device = "efuse";
			key-permit = "write";
		};
		keysn_4:key_4{
			key-name = "mac_bt";
			key-device = "normal";
			key-permit = "read","write","del";
			key-type  = "mac";
		};
		keysn_5:key_5{
			key-name = "mac_wifi";
			key-device = "normal";
			key-permit = "read","write","del";
			key-type = "mac";
		};
		keysn_6:key_6{
			key-name = "hdcp2_tx";
			key-device = "normal";
			key-permit = "read","write","del";
		};
		keysn_7:key_7{
			key-name = "hdcp2_rx";
			key-device = "normal";
			key-permit = "read","write","del";
		};
		keysn_8:key_8{
			key-name = "widevinekeybox";
			key-device = "secure";
			key-permit = "read","write","del";
		};
		keysn_9:key_9{
			key-name = "deviceid";
			key-device = "normal";
			key-permit = "read","write","del";
		};
		keysn_10:key_10{
			key-name = "hdcp22_fw_private";
			key-device = "secure";
			key-permit = "read","write","del";
		};
		keysn_11:key_11{
			key-name = "PlayReadykeybox25";
			key-device = "secure";
			key-permit = "read","write","del";
		};
		keysn_12:key_12{
			key-name = "prpubkeybox";// PlayReady
			key-device = "secure";
			key-permit = "read","write","del";
		};
		keysn_13:key_13{
			key-name = "prprivkeybox";// PlayReady
			key-device = "secure";
			key-permit = "read","write","del";
		};
		keysn_14:key_14{
			key-name = "attestationkeybox";// attestation key
			key-device = "secure";
			key-permit = "read","write","del";
		};
		keysn_15:key_15{
			key-name = "region_code";
			key-device = "normal";
			key-permit = "read","write","del";
		};
		keysn_16:key_16{
			key-name = "netflix_mgkid";
			key-device = "secure";
			key-permit = "read","write","del";
		};
		keysn_17:key_17{
			key-name = "attestationdevidbox";// attest dev id box
			key-device = "secure";
			key-permit = "read","write","del";
		};
		keysn_18:key_18{
			key-name = "oemkey";
			key-device = "normal";
			key-permit = "read","write","del";
		};
		keysn_19:key_19{
			key-name = "lcd";
			key-device = "normal";
			key-permit = "read","write","del";
		};
		keysn_20:key_20{
			key-name = "lcd_extern";
			key-device = "normal";
			key-permit = "read","write","del";
		};
		keysn_21:key_21{
			key-name = "backlight";
			key-device = "normal";
			key-permit = "read","write","del";
		};
	};//End unifykey

	pmic_osc: clock-pmic {
		compatible = "fixed-clock";
		#clock-cells = <0>;
		clock-frequency = <32768>;
		clock-output-names = "pmic_osc";
	};

	hdmirx {
		compatible = "amlogic, hdmirx_t3x";
		#address-cells=<1>;
		#size-cells=<1>;
		/*memory-region = <&hdmirx_emp_cma_reserved>;*/
		status = "okay";
		pinctrl-names = "hdmirx_pins";
		pinctrl-0 = <&hdmirx_a_mux &hdmirx_b_mux
			&hdmirx_c_mux &hdmirx_d_mux>;
		repeat = <0>;
		//power-domains = <&pwrdm PDID_T7_HDMIRX>;
		interrupts = <0 156 IRQ_TYPE_LEVEL_HIGH
		0 157 IRQ_TYPE_LEVEL_HIGH
		0 158 IRQ_TYPE_LEVEL_HIGH
		0 159 IRQ_TYPE_LEVEL_HIGH>;
		interrupt-names = "hdmi0_irq", "hdmi1_irq", "hdmi2_irq", "hdmi3_irq";
		clocks =<&clkc CLKID_HDMIRX_CFG>,
			   <&clkc CLKID_HDMIRX_ACR>,
			   <&clkc CLKID_HDMIRX_METER>,
			   <&clkc CLKID_HDMIRX_2M>,
			   <&clkc CLKID_HDMIRX_5M>,
			   <&clkc CLKID_HDMIRX_HDCP>,
			   <&xtal>,
			   <&clkc CLKID_HDMIRX_AXI>,
			   <&clkc CLKID_FCLK_DIV4>,
			   <&clkc CLKID_FCLK_DIV5>;
		clock-names = "hdmirx_cfg_clk",
				"cts_hdmirx_acr_ref_clk",
				"cts_hdmirx_meter_clk",
				"cts_hdmirx_2m_clk",
				"cts_hdmirx_5m_clk",
				"cts_hdmirx_hdcp2x_eclk",
				"xtal",
				"cts_hdmi_axi_clk",
				"fclk_div4",
				"fclk_div5";
		hdmirx_id = <0>;
		en_4k_2_2k = <0>;
		hpd_low_cec_off = <0>;
		arc_port = <1>;
		/* bit4: enable feature, bit3~0: port number */
		disable_port = <0x0>;
		/* MAP_ADDR_MODULE_CBUS */
		/* MAP_ADDR_MODULE_HIU */
		/* MAP_ADDR_MODULE_HDMIRX_CAPB3 */
		/* MAP_ADDR_MODULE_SEC_AHB */
		/* MAP_ADDR_MODULE_SEC_AHB2 */
		/* MAP_ADDR_MODULE_APB4 */
		/* MAP_ADDR_MODULE_TOP */
		/* MAP_ADDR_MODULE_CLK_CTRL */
		/* MAP_ADDR_MODULE_ANA_CTRL */
		reg = < 0x0 0x0 0x0 0x0
			0x0 0x0 0x0 0x0
			0x0 0x0 0x0 0x0
			0x0 0x0 0x0 0x0
			0x0 0x0 0x0 0x0
			0x0 0x0 0x0 0x0
			0x0 0xfe390000 0x0 0x20000
			0x0 0xfe000000 0x0 0x1fff
			0x0 0xfe008000 0x280 0x334>;
	};

	/* Audio Related start */
	auge_sound {
		compatible = "amlogic, auge-sound-card";
		aml-audio-card,name = "AML-AUGESOUND";

		/*avout mute gpio*/
		avout_mute-gpios = <&gpio GPIOD_6 GPIO_ACTIVE_HIGH>;
		interrupts = <GIC_SPI 83 IRQ_TYPE_EDGE_RISING>;
		interrupt-names = "audio_exception64";

		status = "okay";

		aml-audio-card,dai-link@0 {
			format = "dsp_a";
			mclk-fs = <512>;
			//continuous-clock;
			//bitclock-inversion;
			//frame-inversion;
			/* master mode */
			bitclock-master = <&tdma>;
			frame-master = <&tdma>;
			/* slave mode */
			/*
			 * bitclock-master = <&tdmacodec>;
			 * frame-master = <&tdmacodec>;
			 */
			/* suffix-name, sync with android audio hal used for */
			suffix-name = "alsaPORT-pcm";
			tdmacpu: cpu {
				sound-dai = <&tdma>;
				dai-tdm-slot-tx-mask =
							<1>;
				dai-tdm-slot-rx-mask =
							<1>;
				dai-tdm-slot-num = <2>;
				dai-tdm-slot-width = <16>;
				system-clock-frequency = <256000>;
			};
			tdmacodec: codec {
				sound-dai = <&dummy_codec>;
			};
		};

		aml-audio-card,dai-link@1 {
			format = "i2s";
			mclk-fs = <256>;
			//continuous-clock;
			//bitclock-inversion;
			//frame-inversion;
			/* master mode */
			bitclock-master = <&tdmb>;
			frame-master = <&tdmb>;
			/* slave mode */
			//bitclock-master = <&tdmbcodec>;
			//frame-master = <&tdmbcodec>;
			/* suffix-name, sync with android audio hal
			 * what's the dai link used for
			 */
			suffix-name = "alsaPORT-i2s-i2s4hdmirx";
			cpu {
				sound-dai = <&tdmb>;
				dai-tdm-slot-tx-mask = <1 1>;
				dai-tdm-slot-rx-mask = <1 1>;
				dai-tdm-slot-num = <2>;
				/*
				 * dai-tdm-slot-tx-mask =
				 *	<1 1 1 1 1 1 1 1>;
				 * dai-tdm-slot-rx-mask =
				 *	<1 1 1 1 1 1 1 1>;
				 * dai-tdm-slot-num = <8>;
				 */
				dai-tdm-slot-width = <32>;
				system-clock-frequency = <12288000>;
			};
			tdmbcodec: codec {
				prefix-names = "AMP";
				sound-dai = <&ad82128 &acodec>;
			};
		};

		aml-audio-card,dai-link@2 {
			format = "i2s";
			mclk-fs = <256>;
			//continuous-clock;
			//bitclock-inversion;
			//frame-inversion;
			/* master mode */
			bitclock-master = <&tdmc>;
			frame-master = <&tdmc>;
			/* slave mode */
			//bitclock-master = <&tdmccodec>;
			//frame-master = <&tdmccodec>;
			/* suffix-name, sync with android audio hal used for */
			suffix-name = "alsaPORT-i2s4parser";
			cpu {
				sound-dai = <&tdmc>;
				dai-tdm-slot-tx-mask = <1 1>;
				dai-tdm-slot-rx-mask = <1 1>;
				dai-tdm-slot-num = <2>;
				dai-tdm-slot-width = <32>;
				system-clock-frequency = <12288000>;
			};
			tdmccodec: codec {
				sound-dai = <&dummy_codec>;
			};
		};
		aml-audio-card,dai-link@3 {
			format = "i2s";
			mclk-fs = <256>;
			//continuous-clock;
			//bitclock-inversion;
			//frame-inversion;
			/* master mode */
			bitclock-master = <&tdmd>;
			frame-master = <&tdmd>;
			/* slave mode */
			/* suffix-name, sync with android audio hal used for */
			suffix-name = "alsaPORT-tdm-d";
			cpu {
				sound-dai = <&tdmd>;
				dai-tdm-slot-tx-mask = <1 1>;
				dai-tdm-slot-rx-mask = <1 1>;
				dai-tdm-slot-num = <2>;
				dai-tdm-slot-width = <32>;
				system-clock-frequency = <12288000>;
			};
			tdmd_codec: codec {
				sound-dai = <&dummy_codec>;
			};
		};
		aml-audio-card,dai-link@4 {
			mclk-fs = <64>;
			/* suffix-name, sync with android audio hal
			 * what's the dai link used for
			 */
			suffix-name = "alsaPORT-pdm-builtinmic";
			cpu {
				sound-dai = <&pdm>;
			};
			codec {
				sound-dai = <&dummy_codec>;
			};
		};
		aml-audio-card,dai-link@5 {
			mclk-fs = <128>;
			continuous-clock;
			/* suffix-name, sync with android audio hal used for */
			suffix-name = "alsaPORT-spdif";
			cpu {
				sound-dai = <&spdifa>;
				system-clock-frequency = <6144000>;
			};
			codec {
				sound-dai = <&dummy_codec>;
			};
		};

		/* spdif_b to hdmi, only playback */
		aml-audio-card,dai-link@6 {
			mclk-fs = <128>;
			continuous-clock;
			/* suffix-name, sync with android audio hal
			 * what's the dai link used for
			 */
			suffix-name = "alsaPORT-spdifb";
			cpu {
				sound-dai = <&spdifb>;
				system-clock-frequency = <6144000>;
			};
			codec {
				sound-dai = <&dummy_codec>;
			};
		};

		aml-audio-card,dai-link@7 {
			mclk-fs = <256>;
			continuous-clock;
			suffix-name = "alsaPORT-loopback";
			cpu {
				sound-dai = <&loopbacka>;
				system-clock-frequency = <12288000>;
			};
			codec {
				sound-dai = <&dummy_codec>;
			};
		};

		aml-audio-card,dai-link@8 {
			mclk-fs = <256>;
			suffix-name = "alsaPORT-tv";
			cpu {
				sound-dai = <&extn>;
				system-clock-frequency = <12288000>;
			};
			codec {
				sound-dai = <&dummy_codec>;
			};
		};
		aml-audio-card,dai-link@9 {
			mclk-fs = <256>;
			suffix-name = "alsaPORT-earc";
			cpu {
				sound-dai = <&earc>;
				system-clock-frequency = <12288000>;
			};
			codec {
				sound-dai = <&dummy_codec>;
			};
		};
	};
	/* Audio Related end */

	picdec {
		compatible = "amlogic, picdec";
		status = "okay";
	};

	amdolby_vision {
		compatible = "amlogic, dolby_vision_s5";
		dev_name = "aml_amdolby_vision_driver";
		status = "disabled";
		tv_mode = <0>;/*1:enable ;0:disable*/
		multi_core1 = <1>;
	};

	aml_frc {
		compatible = "amlogic, t3x_frc";
		dev_name = "aml_frc";
		status = "disable";
		frc_en = <0>;/*1:enable ;0:disable*/
		frc_hw_pos = <0>;/*0:before postblend; 1:after postblend*/
		interrupts = <GIC_SPI 291 IRQ_TYPE_EDGE_RISING
				GIC_SPI 292 IRQ_TYPE_EDGE_RISING
				GIC_SPI 288 IRQ_TYPE_EDGE_RISING>;
		interrupt-names = "irq_frc_in", "irq_frc_out", "irq_frc_rdma";
		memory-region = <&frc_cma_reserved>;
		clocks = <&clkc CLKID_FRC>, <&clkc CLKID_ME>;
		clock-names = "clk_frc", "clk_me";
		power-domains = <&pwrdm PDID_T3X_FRC_TOP>;
		power-domain-names = "frc-top";
		reg = <0x0 0xFF850000 0x0 0x30000 /*frc reg*/
		       0x0 0xFE000000 0x0 0x300
		       0x0 0xFF000000 0x0 0x10000>; /*frc clk reg*/
		reg-names = "frc_reg","frc_clk_reg","vpu_reg";
	};

	/* SMC */
	smartcard {
		compatible = "amlogic,smartcard-sc2";
		dev_name = "smartcard";
		status = "disabled";

		reg = <0x0 0xfe000000 0x0 0x480000>;
		irq_trigger_type = "GPIO_IRQ_LOW";

		reset_pin-gpios = <&gpio GPIOZ_3 GPIO_ACTIVE_HIGH>;
		detect_pin-gpios = <&gpio GPIOM_27 GPIO_ACTIVE_HIGH>;
		enable_5v3v_pin-gpios = <&gpio GPIOM_28 GPIO_ACTIVE_HIGH>;
		enable_pin-gpios = <&gpio GPIOZ_2 GPIO_ACTIVE_HIGH>;

		interrupts = <0 81 1>; //?
		interrupt-names = "smc0_irq";
		/*
		 *Smc clock source, if change this,
		 *you must adjust clk and divider in smartcard.c
		 */
		smc0_clock_source = <0>;
		/*0: high voltage on detect pin indicates card in.*/
		smc0_det_invert = <0>;
		smc0_5v3v_level = <0>;
		/*Ordinarily,smartcard controller needs a enable pin.*/
		smc_need_enable_pin = "yes";
		reset_level = <0>;
		smc0_enable_level = <0>;

		pinctrl-names = "default";
		pinctrl-0 = <&sd_iso7816_pins>;
		clocks = <&clkc CLKID_SYS_CLK_SMARTCARD>;
		clock-names = "smartcard";
	};

	atv-demod {
		compatible = "amlogic, atv-demod";
		status = "okay";
		btsc_sap_mode = <1>;
		interrupts = <0 93 1>;
		pinctrl-names="atvdemod_agc_pins";
		pinctrl-0=<&atvdemod_agc_pins>;
		reg = <0x0 0xfe062000 0x0 0x2000    // demod reg
				0x0 0xfe000000 0x0 0x2000   // hiu reg
				0x0 0x0 0x0 0x0             // periphs reg
				0x0 0xfe04e000 0x0 0x2000>; // adec reg
		common_agc = <1>;
	};

	aml_dtv_demod {
		compatible = "amlogic, ddemod-t3x";
		dev_name = "aml_dtv_demod";
		status = "okay";
		diseqc_name = "sgm_41286";
		pinctrl-names="if_agc_pins", "diseqc_out", "rf_agc_pins";
		pinctrl-0=<&dtvdemod_if_agc_pins>;
		pinctrl-1=<&diseqc_out>;
		pinctrl-2=<&dtvdemod_rf_agc_pins>;
		//pinctrl-3=<&diseqc_in>;
		lnb_en-gpios = <&gpio GPIOZ_2 GPIO_ACTIVE_HIGH>;
		lnb_sel-gpios = <&gpio GPIOZ_3 GPIO_ACTIVE_HIGH>;
		interrupts = <GIC_SPI 91 IRQ_TYPE_EDGE_RISING>;
		interrupt-names = "demod_isr";
		power-domains = <&pwrdm PDID_T3X_DEMOD>;
		clocks = <&clkc CLKID_DEMOD_32K>;
		clock-names = "demod_32k";
		reg = <0x0 0xfe360000 0x0 0x10000	//dtv demod base
			   0x0 0xfe000000 0x0 0x2000	//hiu reg base
			   0x0 0xff800000 0x0 0x1000	//io_aobus_base
			   0x0 0xfe002000 0x0 0x2000>;	//reset

		spectrum = <1>;
		cma_mem_size = <40>; // MB
	};

	dvb-extern {
		compatible = "amlogic, dvb-extern";
		dev_name = "dvb-extern";
		status = "okay";

		fe_num = <1>;
		fe0_demod = "internal";

		tuner_num = <2>; // tuner number, multi tuner support
		tuner0_name = "r842_tuner";
		tuner0_i2c_adap = <&i2c0>;
		tuner0_i2c_addr = <0xF6>; // 8 bits
		tuner0_xtal = <1>;       // 0: 16MHz, 1: 24MHz
		tuner0_xtal_mode = <0>;  // NO_SHARE_XTAL(0), SLAVE_XTAL_SHARE(3)
		tuner0_xtal_cap = <38>;

		tuner1_name = "rt710_tuner";
		tuner1_i2c_adap = <&i2c0>;
		tuner1_i2c_addr = <0xF4>; // 8 bits
		tuner1_xtal = <0>;       // 0: 16MHz, 1: 24MHz
		tuner1_xtal_mode = <0>;  // NO_SHARE_XTAL(0), SLAVE_XTAL_SHARE(3)
		tuner1_xtal_cap = <30>;
	};

	dvb-demux {
		compatible = "amlogic sc2, dvb-demux";
		dev_name = "dvb-demux";
		status = "okay";

		reg = <0x0 0xfe000000 0x0 0x480000>;

		dmxdev_num = <0x11>;

		tsn_from = "demod";

		/*single demod setting */
		ts1_sid = <0x21>;
		ts1 = "parallel";
		ts1_control = <0x0>;
		ts1_invert = <0>;

		pinctrl-names = "p_ts1";
		pinctrl-0 = <&dvb_p_ts1_pins>;

		ts3_sid = <0x23>;
		ts3 = "parallel"; /* tsind: parallel */
		ts3_control = <0x0>;
		ts3_invert = <0>;

	};

	dvbci {
		compatible = "amlogic, dvbci";
		dev_name = "dvbci";
		status = "okay";
		io_type = <4>; /* 0=iobus,1=spi,2=cimax,3=spi-t312 4:T5D,ci bus*/
		addr_ts_mode_multiplex = <0>; /*AY301 not multi ts and addr,default 1*/
		le_enable_level = <0>; /*LE pin enable level*/
		/*gpio pin define*/
		pinctrl-names= "ci_ts_pins";
		pinctrl-0=<&dvb_ci_bus_pins_all &ci_ts_pins &ci_ts_clk_pins>;
		reg = <0x0 0xFE04A000 0x0 0x1FFF>;
		/*irq define dvbci not use irq now*/
		interrupts = <0 150 1
				0 151 1>;
		interrupt-names = "irq_cmp",
				  "irq_timeout";

		dvbci_io {
			/*gpio define  GPIOM_27 GPIOM_28 GPIOM_30*/
			cd_pin1 = <&gpio       GPIOM_27       GPIO_ACTIVE_HIGH>;
			pwr_pin = <&gpio       GPIOM_28       GPIO_ACTIVE_HIGH>;
			le_pin = <&gpio        GPIOM_29       GPIO_ACTIVE_HIGH>;
		};
	};

	ppmgr {
		compatible = "amlogic, ppmgr";
		memory-region = <&ppmgr_reserved>;
		dev_name = "ppmgr";
		status = "okay";
	};

	video_queue {
		compatible = "amlogic, video_queue";
		dev_name = "videoqueue";
		status = "okay";
	};

	ionvideo {
		compatible = "amlogic, ionvideo";
		dev_name = "ionvideo";
		status = "okay";
	};

	amlvideo2_0 {
		compatible = "amlogic, amlvideo2";
		dev_name = "amlvideo2";
		status = "okay";
		amlvideo2_id = <0>;
		cma_mode = <1>;
	};

	amlvideo2_1 {
		compatible = "amlogic, amlvideo2";
		dev_name = "amlvideo2";
		status = "okay";
		amlvideo2_id = <1>;
		cma_mode = <1>;
	};

	gpio_keypad{
		compatible = "amlogic, gpio_keypad";
		status = "disabled";
		scan_period = <20>;
		key_num = <2>;
		key_name = "bluetooth", "mute";
		key_code = <600 SW_MUTE_DEVICE>;
		key_type = <EV_KEY EV_SW>;
		//key-gpios = <&gpio GPIOD_2 GPIO_ACTIVE_HIGH
		//	     &gpio GPIOA_7 GPIO_ACTIVE_HIGH>;
		detect_mode = <0>;/*0:polling mode, 1:irq mode*/
	};

	adc_keypad {
		compatible = "amlogic, adc_keypad";
		status = "disabled";
		key_name = "key_a", "key_b", "key_c";
		key_num = <3>;
		io-channels = <&saradc 0>;
		io-channel-names = "key-chan-0";
		key_chan = <0 0 0>;
		key_code = <141 114 115>;
		key_val = <900 511 0>; //val=voltage/1800mV*1023
		key_tolerance = <40 40 40>;
	};

	vddao3v3_reg: fixed@vddao3v3_reg {
		vin-supply = <&v_12v>;
		compatible = "regulator-fixed";
		regulator-name = "VDDAO_3.3V";
		regulator-min-microvolt = <3300000>;
		regulator-max-microvolt = <3300000>;
		regulator-boot-on;
		regulator-always-on;
	};

	vddao1v8_reg: fixed@vddao1v8_reg {
		compatible = "regulator-fixed";
		vin-supply = <&vddao3v3_reg>;
		regulator-name = "VDDAO_1.8V";
		regulator-min-microvolt = <1800000>;
		regulator-max-microvolt = <1800000>;
		regulator-boot-on;
		regulator-always-on;
	};

	vccio3v3_reg: fixed@vccio3v3_reg {
		vin-supply = <&vddao3v3_reg>;
		compatible = "regulator-fixed";
		regulator-name = "VDDIO_3.3V";
		regulator-min-microvolt = <3300000>;
		regulator-max-microvolt = <3300000>;
		pinctrl-names = "default";
		gpio = <&gpio GPIOD_10 GPIO_ACTIVE_HIGH>;
		startup-delay-us = <70000>;
		enable-active-high;
		regulator-boot-on;
		regulator-always-on;
	};

	vddio_b_reg: fixed@vddio_b_reg {
		vin-supply = <&vddao3v3_reg>;
		compatible = "regulator-fixed";
		regulator-name = "VDDIO_B";
		regulator-min-microvolt = <3300000>;
		regulator-max-microvolt = <3300000>;
		pinctrl-names = "default";
		gpio = <&gpio GPIOD_14 GPIO_ACTIVE_HIGH>;
		startup-delay-us = <70000>;
		enable-active-high;
		regulator-boot-on;
		regulator-always-on;
	};
};

&audiobus {
	tdma:tdm@0 {
		compatible = "amlogic, t3x-snd-tdma";
		#sound-dai-cells = <0>;

		dai-tdm-lane-slot-mask-in = <1 0>;
		dai-tdm-lane-slot-mask-out = <1 1>;
		dai-tdm-clk-sel = <0>;

		clocks = <&clkaudio CLKID_AUDIO_MCLK_A
				&clkc CLKID_HIFI_PLL
				&clkc CLKID_HIFI1_PLL>;
		clock-names = "mclk", "clk_srcpll", "clk_src_cd";

		/* enable control gain */
		ctrl_gain = <1>;
		status = "okay";
	};

	tdmb:tdm@1 {
		compatible = "amlogic, t3x-snd-tdmb";
		#sound-dai-cells = <0>;

		dai-tdm-lane-slot-mask-in = <1 1 1 1>;
		dai-tdm-lane-slot-mask-out = <1 1 1 1>;
		dai-tdm-clk-sel = <1>;

		clocks = <&clkaudio CLKID_AUDIO_MCLK_B
				&clkc CLKID_HIFI_PLL
				&clkc CLKID_HIFI1_PLL>;
		clock-names = "mclk", "clk_srcpll", "clk_src_cd";

		pinctrl-names = "tdm_pins","tdmout_a_gpio";
		pinctrl-0 =
			<&tdm_b_pins
			&tdm_d0_pins
			&tdmb_clk_pins>;
		pinctrl-1 = <&tdmout_a_gpio>;
		/*
		 * 0: tdmout_a;
		 * 1: tdmout_b;
		 * 2: tdmout_c;
		 * 3: spdifout;
		 * 4: spdifout_b;
		 */
		samesource_sel = <3>;
		/* In for ACODEC_ADC */
		/* tdmin-src-name = "acodec_adc"; */
		tdmin-src-name = "hdmirx";
		/*enable default mclk(12.288M), before extern codec start*/
		start_clk_enable = <1>;

		/*tdm clk tuning enable*/
		clk_tuning_enable = <1>;

		/* enable control gain */
		ctrl_gain = <1>;

		/* pcpd_monitor*/
		pcpd_monitor_src = <&pcpd_monitor_a>;
		status = "okay";

		/* !!!For --TV platform-- ONLY */
		Channel_Mask {
			/*i2s has 4 pins, 8channel, mux output*/
			Spdif_samesource_Channel_Mask = "i2s_2/3";
		};
	};

	tdmc:tdm@2 {
		compatible = "amlogic, t3x-snd-tdmc";
		#sound-dai-cells = <0>;

		dai-tdm-lane-slot-mask-in = <1 1 1 1>;
		dai-tdm-lane-slot-mask-out = <1 0 0 0>;
		dai-tdm-clk-sel = <2>;

		clocks = <&clkaudio CLKID_AUDIO_MCLK_C
				&clkc CLKID_HIFI_PLL
				&clkc CLKID_HIFI1_PLL>;
		clock-names = "mclk", "clk_srcpll", "clk_src_cd";

		/* enable control gain */
		tdmin-src-name = "hdmirx";
		ctrl_gain = <1>;
		status = "okay";
	};

	tdmd:tdm@3 {
		compatible = "amlogic, t3x-snd-tdmd";
		#sound-dai-cells = <0>;

		dai-tdm-lane-slot-mask-in = <1 0 0 0>;
		dai-tdm-lane-slot-mask-out = <1 1 1 1>;
		dai-tdm-clk-sel = <3>;

		clocks = <&clkaudio CLKID_AUDIO_GATE_TDMIND
				&clkaudio CLKID_AUDIO_GATE_TDMOUTD
				&clkaudio CLKID_AUDIO_MCLK_D
				&clkaudio CLKID_AUDIO_MCLK_PAD3
				&clkc CLKID_HIFI_PLL
				&clkc CLKID_HIFI1_PLL>;
		clock-names = "gate_in", "gate_out", "mclk",
					"mclk_pad", "clk_srcpll", "clk_src_cd";
		status = "okay";
	};

	pdm:pdm {
		compatible = "amlogic, tm2-revb-snd-pdm";
		#sound-dai-cells = <0>;

		clocks = <&clkaudio CLKID_AUDIO_GATE_PDM
			&clkc CLKID_FCLK_DIV3
			&clkc CLKID_HIFI_PLL
			&clkaudio CLKID_AUDIO_PDMIN0
			&clkaudio CLKID_AUDIO_PDMIN1>;
		clock-names = "gate",
			"sysclk_srcpll",
			"dclk_srcpll",
			"pdm_dclk",
			"pdm_sysclk";
		pinctrl-names = "pdm_pins";
		pinctrl-0 = <&pdmin>;
		src-clk-freq = <491520000>;
		train_sample_count = <10>;

		/* mode 0~4, defalut:1 */
		filter_mode = <1>;

		status = "okay";
	};

	spdifa:spdif@0 {
		compatible = "amlogic, tm2-revb-snd-spdif-a";
		#sound-dai-cells = <0>;

		clocks = <&clkc CLKID_HIFI_PLL
				&clkc CLKID_HIFI1_PLL
				&clkc CLKID_FCLK_DIV4
				&clkaudio CLKID_AUDIO_GATE_SPDIFIN
				&clkaudio CLKID_AUDIO_GATE_SPDIFOUT_A
				&clkaudio CLKID_AUDIO_SPDIFIN
				&clkaudio CLKID_AUDIO_SPDIFOUT_A>;
		clock-names = "sysclk", "clk_src_cd", "fixed_clk", "gate_spdifin",
				"gate_spdifout", "clk_spdifin", "clk_spdifout";

		interrupts =
				<GIC_SPI 35 IRQ_TYPE_EDGE_RISING>;
		interrupt-names = "irq_spdifin";
		pinctrl-names = "spdif_pins",
			"spdif_pins_mute";
		pinctrl-0 = <&spdif_out_a_z19_pins>;
		pinctrl-1 = <&spdifout_a_mute_pins>;
		/*
		 * 0: tdmout_a;
		 * 1: tdmout_b;
		 * 2: tdmout_c;
		 * 3: spdifout;
		 * 4: spdifout_b;
		 * 5: earc;
		 */

		samesource_sel = <5>;

		/*spdif clk tuning enable*/
		clk_tuning_enable = <1>;
		src-clk-freq = <491520000>;
		suspend-clk-off = <1>;
		status = "okay";
	};

	spdifb:spdif@1 {
		compatible = "amlogic, tm2-revb-snd-spdif-b";
		#sound-dai-cells = <0>;

		clocks = <&clkc CLKID_HIFI_PLL /*CLKID_HIFI_PLL*/
				&clkc CLKID_HIFI1_PLL
				&clkaudio CLKID_AUDIO_GATE_SPDIFOUT_B
				&clkaudio CLKID_AUDIO_SPDIFOUT_B>;
		clock-names = "sysclk", "clk_src_cd",
				"gate_spdifout", "clk_spdifout";
		src-clk-freq = <491520000>;
		suspend-clk-off = <1>;
		status = "okay";
	};

	extn:extn {
		compatible = "amlogic, t7-snd-extn";
		#sound-dai-cells = <0>;

		interrupts =
				<GIC_SPI 42 IRQ_TYPE_EDGE_RISING>;
		interrupt-names = "irq_frhdmirx";

		status = "okay";
	};

	aed:effect {
		compatible = "amlogic, snd-effect-v4";
		#sound-dai-cells = <0>;

		clocks = <&clkaudio CLKID_AUDIO_GATE_EQDRC
			&clkc CLKID_FCLK_DIV5
			&clkaudio CLKID_AUDIO_EQDRC>;
		clock-names = "gate", "srcpll", "eqdrc";

		/*
		 * 0:tdmout_a
		 * 1:tdmout_b
		 * 2:tdmout_c
		 * 3:spdifout
		 * 4:spdifout_b
		 */
		eqdrc_module = <1>;
		/* max 0xf, each bit for one lane, usually one lane */
		lane_mask = <0x1>;
		/* max 0xff, each bit for one channel */
		channel_mask = <0xff>;

		status = "okay";
	};

	asrca: resample@0 {
		compatible = "amlogic, t3x-resample-a";
		clocks = <&clkc CLKID_HIFI_PLL
			&clkaudio CLKID_AUDIO_MCLK_B
			&clkaudio CLKID_AUDIO_RESAMPLE_A>;
		clock-names = "resample_pll", "resample_src", "resample_clk";

		/*same with toddr_src
		 *	TDMIN_A,    0
		 *	TDMIN_B,    1
		 *	TDMIN_C,    2
		 *	SPDIFIN,    3
		 *	PDMIN,      4
		 *	FRATV,      5
		 *	TDMIN_LB,   6
		 *	LOOPBACK_A, 7
		 *	FRHDMIRX,   8
		 *	LOOPBACK_B, 9
		 *	SPDIFIN_LB, 10
		 *	EARC_RX,    11
		 */
		src-clk-freq = <491520000>;
		resample_module = <8>;
		suspend-clk-off = <1>;
		status = "okay";
	};

	asrcb: resample@1 {
		compatible = "amlogic, t3x-resample-b";
		clocks = <&clkc CLKID_HIFI_PLL
			&clkaudio CLKID_AUDIO_MCLK_F
			&clkaudio CLKID_AUDIO_RESAMPLE_B>;
		clock-names = "resample_pll", "resample_src", "resample_clk";
		src-clk-freq = <491520000>;

		/*this resample is only used for loopback_A.*/
		suspend-clk-off = <1>;
		status = "okay";
	};

	asrcc: resample@2 {
		compatible = "amlogic, t3x-resample-c";
		clocks = <&clkc CLKID_HIFI_PLL
			&clkaudio CLKID_AUDIO_MCLK_B
			&clkaudio CLKID_AUDIO_RESAMPLE_C>;
		clock-names = "resample_pll", "resample_src", "resample_clk";

		/*same with toddr_src
		 *	TDMIN_A,    0
		 *	TDMIN_B,    1
		 *	TDMIN_C,    2
		 *	SPDIFIN,    3
		 *	PDMIN,      4
		 *	FRATV,      5
		 *	TDMIN_LB,   6
		 *	LOOPBACK_A, 7
		 *	FRHDMIRX,   8
		 *	LOOPBACK_B, 9
		 *	SPDIFIN_LB, 10
		 *	EARC_RX,    11
		 */
		src-clk-freq = <491520000>;
		resample_module = <8>;
		suspend-clk-off = <1>;
		status = "okay";
	};

	vad:vad {
		compatible = "amlogic, snd-vad";
		#sound-dai-cells = <0>;

		clocks = <&clkaudio CLKID_AUDIO_GATE_TOVAD
			&clkc CLKID_FCLK_DIV5
			&clkaudio CLKID_AUDIO_VAD>;
		clock-names = "gate", "pll", "clk";

		interrupts = <GIC_SPI 39 IRQ_TYPE_EDGE_RISING
				GIC_SPI 44 IRQ_TYPE_EDGE_RISING>;
		interrupt-names = "irq_wakeup", "irq_frame_sync";

		/*
		 * Data src sel:
		 * 0: tdmin_a;
		 * 1: tdmin_b;
		 * 2: tdmin_c;
		 * 3: spdifin;
		 * 4: pdmin;
		 * 5: loopback_b;
		 * 6: tdmin_lb;
		 * 7: loopback_a;
		 */
		src = <4>;

		/*
		 * deal with hot word in user space or kernel space
		 * 0: in user space
		 * 1: in kernel space
		 */
		level = <1>;

		mic-src = <&pdm>;
		wakeup_sample_rate = <16000>;

		status = "okay";
	};

	loopbacka:loopback@0 {
		compatible = "amlogic, t5-loopbacka";
		#sound-dai-cells = <0>;

		clocks = <&clkaudio CLKID_AUDIO_GATE_PDM
			&clkc CLKID_FCLK_DIV3
			&clkc CLKID_HIFI_PLL
			&clkaudio CLKID_AUDIO_PDMIN0
			&clkaudio CLKID_AUDIO_PDMIN1
			&clkc CLKID_HIFI_PLL
			&clkaudio CLKID_AUDIO_MCLK_A>;
		clock-names = "pdm_gate",
			"pdm_sysclk_srcpll",
			"pdm_dclk_srcpll",
			"pdm_dclk",
			"pdm_sysclk",
			"tdminlb_mpll",
			"tdminlb_mclk";

		/* datain src
		 * 0: tdmin_a;
		 * 1: tdmin_b;
		 * 2: tdmin_c;
		 * 3: spdifin;
		 * 4: pdmin;
		 */
		datain_src = <4>;
		datain_chnum = <4>;
		datain_chmask = <0xf>;
		/* config which data pin for loopback */
		datain-lane-mask-in = <1 1 0 0>;

		/* calc mclk for datalb */
		mclk-fs = <256>;
		src-clk-freq = <491520000>;
		/* tdmin_lb src
		 * 0: tdmoutA
		 * 1: tdmoutB
		 * 2: tdmoutC
		 * 3: PAD_TDMINA_DIN*, refer to core pinmux
		 * 4: PAD_TDMINB_DIN*, refer to core pinmux
		 * 5: PAD_TDMINC_DIN*, refer to core pinmux
		 * 6: PAD_TDMINA_D*, oe, refer to core pinmux
		 * 7: PAD_TDMINB_D*, oe, refer to core pinmux
		 */
		/* if tdmin_lb >= 3, use external loopback */
		datalb_src = <1>;
		datalb_chnum = <2>;
		datalb_chmask = <0x3>;
		/* config which data pin as loopback */
		datalb-lane-mask-in = <1 0 0 0>;

		/* define loopack with pdm mic. */
		mic-src = <&pdm>;
		status = "okay";
	};

	loopbackb:loopback@1 {
		compatible = "amlogic, t5-loopbackb";
		#sound-dai-cells = <0>;

		clocks = <&clkaudio CLKID_AUDIO_GATE_PDM
			&clkc CLKID_FCLK_DIV3
			&clkc CLKID_HIFI_PLL
			&clkaudio CLKID_AUDIO_PDMIN0
			&clkaudio CLKID_AUDIO_PDMIN1
			&clkc CLKID_HIFI_PLL
			&clkaudio CLKID_AUDIO_MCLK_A>;
		clock-names = "pdm_gate",
			"pdm_sysclk_srcpll",
			"pdm_dclk_srcpll",
			"pdm_dclk",
			"pdm_sysclk",
			"tdminlb_mpll",
			"tdminlb_mclk";

		/* calc mclk for datain_lb */
		mclk-fs = <256>;

		/* datain src
		 * 0: tdmin_a;
		 * 1: tdmin_b;
		 * 2: tdmin_c;
		 * 3: spdifin;
		 * 4: pdmin;
		 */
		datain_src = <4>;
		datain_chnum = <4>;
		datain_chmask = <0xf>;
		/* config which data pin for loopback */
		datain-lane-mask-in = <1 0 1 0>;

		/* tdmin_lb src
		 * 0: tdmoutA
		 * 1: tdmoutB
		 * 2: tdmoutC
		 * 3: PAD_TDMINA_DIN*, refer to core pinmux
		 * 4: PAD_TDMINB_DIN*, refer to core pinmux
		 * 5: PAD_TDMINC_DIN*, refer to core pinmux
		 * 6: PAD_TDMINA_D*, oe, refer to core pinmux
		 * 7: PAD_TDMINB_D*, oe, refer to core pinmux
		 */
		/* if tdmin_lb >= 3, use external loopback */
		datalb_src = <1>;
		datalb_chnum = <2>;
		datalb_chmask = <0x3>;
		/* config which data pin as loopback */
		datalb-lane-mask-in = <1 0 0 0>;
		suspend-clk-off = <1>;
		status = "disabled";
	};
}; /* end of audiobus */

&earc {
	suspend-clk-off = <1>;
	status = "okay";
};

&crg21_otg {
	status = "okay";
	controller-type = <1>;
};

&crg20 {
	compatible = "amlogic, crg-host-drd";
	status = "okay";
};

&crg31 {
	compatible = "amlogic, crg-host-drd";
	status = "okay";
};

&crg30_drd {
	compatible = "amlogic, crg-drd";
	status = "okay";
};

&usb2_m31_0_phy {
	status = "okay";
};

&usb3_m31_0_phy {
	status = "okay";
	portnum = <1>;
};

&usb2_m31_1_phy {
	status = "okay";
};

&usb3_m31_1_phy {
	status = "okay";
	portnum = <0>;
};

&crg_phy_20 {
	status = "okay";
	portnum = <2>;
};

&crg3_phy_20 {
	status = "okay";
	portnum = <0>;
};

&crg_udc_2 {
	status = "okay";
	controller-type = <4>;
};

&pcie {
	reset-gpio = <&gpio GPIOP_4 GPIO_ACTIVE_HIGH>;
	iommu-map = <0x100 &smmu 0x5 0x10>;
	status = "disabled";
};

&i2c4 {
	clock-frequency = <400000>;
	pinctrl-names = "default";
	pinctrl-0 = <&i2c4_pins1>;
	status = "disabled";
	#address-cells = <1>;
	#size-cells = <0>;
};

&i2c1 {
	status = "okay";
	pinctrl-names="default";
	pinctrl-0=<&i2c1_pins1>;
	ad82128: ad82128@34 {
		compatible = "ESMT,ad82128";
		#sound-dai-cells = <0>;
		reset_pin = <&gpio GPIOD_9 GPIO_ACTIVE_HIGH>;
		reg = <0x34>;
		status = "okay";
	};
};

&csiphy2 {
	port {
		csiphy2_ep: endpoint {
		clock-lanes = <1>;
		data-lanes = <0 1>;
		//remote-endpoint = <&ov9285_2_ep>;
		};
	};
};

&isp2 {
	memory-region = <&camera_cma_reserved>;
};

&csiphy3 {
	port {
		csiphy3_ep: endpoint {
		clock-lanes = <1>;
		data-lanes = <3 4>;
		//remote-endpoint = <&ov9285_3_ep>;
		};
	};
};

&isp3 {
	memory-region = <&camera_cma_reserved>;
};

&i2c2 {
	status = "disabled";
	pinctrl-names="default";
	pinctrl-0=<&i2c2_pins2>;
	clock-frequency = <300000>;
};

/* SDIO */
/* ref board pcie wifi */
&sd_emmc_a {
	status = "disabled";
	pinctrl-0 = <&sdio_pins>;
	pinctrl-1 = <&sdio_clk_gate_pins>;
	pinctrl-names = "default", "clk-gate";
	#address-cells = <1>;
	#size-cells = <0>;

	bus-width = <4>;
	cap-sd-highspeed;
	sd-uhs-sdr50;
	sd-uhs-sdr104;
	max-frequency = <200000000>;

	non-removable;
	disable-wp;

	//vmmc-supply = <&sdcard_3v3>;
	//vqmmc-supply = <&vddio_c>;

	brcmf: wifi@1 {
		reg = <1>;
		compatible = "brcm,bcm4329-fmac";
	};
};

/* SD card */
&sd_emmc_b {
	status = "disabled";
	pinctrl-0 = <&sdcard_pins>;
	pinctrl-1 = <&sdcard_clk_gate_pins>;
	pinctrl-2 = <&sd_1bit_pins>;
	//pinctrl-3 = <&sd_to_ao_uart_clr_pins
	//	&sdcard_pins &ao_to_sd_uart_pins>;
	//pinctrl-4 = <&sd_to_ao_uart_clr_pins
	//	&sd_1bit_pins &ao_to_sd_uart_pins>;
	//pinctrl-5 = <&sdcard_pins &ao_uart_pins>;
	//pinctrl-6 = <&sd_to_ao_uart_clr_pins
	//	&ao_to_sd_uart_pins>;
	//pinctrl-7 = <&sdcard_pins &ao_uart_pins>;
	//pinctrl-8 = <&sd_to_ao_uart_clr_pins
	//	&ao_to_sd_uart_pins>;
	pinctrl-names = "sd_default",
			"clk-gate",
			"sd_1bit_pins";
	//		"sd_clk_cmd_uart_pins",
	//		"sd_1bit_uart_pins",
	//		"sd_to_ao_uart_pins",
	//		"ao_to_sd_uart_pins",
	//		"sd_to_ao_jtag_pins",
	//		"ao_to_sd_jtag_pins";
	bus-width = <4>;
	cap-sd-highspeed;
	//sd-uhs-sdr12;
	//sd-uhs-sdr25;
	//sd-uhs-sdr50;
	//sd-uhs-sdr104;
	max-frequency = <200000000>;
	disable-wp;

	cd-gpios = <&gpio GPIOC_10 GPIO_ACTIVE_HIGH>;
	//dat1-gpios = <&gpio GPIOC_1 GPIO_ACTIVE_HIGH>;
	//vmmc-supply = <&sdcard_3v3>;
	//vqmmc-supply = <&vddio_c>;
};

&sd_emmc_c {
	status = "okay";
	pinctrl-0 = <&emmc_pins>, <&emmc_ds_pins>;
	pinctrl-1 = <&emmc_clk_gate_pins>;
	pinctrl-names = "default", "clk-gate";

	bus-width = <8>;
	cap-mmc-highspeed;
	mmc-ddr-1_8v;
	mmc-hs200-1_8v;
	mmc-hs400-1_8v;
	//mmc-hs400-enhanced-strobe;
	max-frequency = <200000000>;
	non-removable;
	disable-wp;
	init_core_phase = <2>;
//	mmc-pwrseq = <&emmc_pwrseq>;
//	vmmc-supply = <&sdcard_3v3>;
//	vqmmc-supply = <&vddio_c>;
};

&saradc {
	status = "disabled";
};

&ethmac {
	status = "okay";
	phy-handle = <&internal_ephy>;
	phy-mode = "rmii";
};

&uart_A {
	status = "disabled";
};

&ir {
	status = "okay";
	pinctrl-0 = <&remote_pins>;
	pinctrl-names = "default";
};

&spifc {
	status = "disabled";
	spi-nor@0 {
		status = "disabled";
	};
};

&spicc0 {	//for TCON
	status = "disabled";
	pinctrl-names = "default";
	pinctrl-0 = <&spicc0_pins_h>;
};

&spicc1 {	//for UWB/LocalDimm
	status = "disabled";
	pinctrl-names = "default";
	pinctrl-0 = <&spicc1_pins_h>;
};

&spicc2 {
	status = "disabled";
	pinctrl-names = "default";
	pinctrl-0 = <&spicc2_pins_c>;
};

&fb {
	status = "okay";
	display_size_default = <3840 2160 3840 4320 32>;
	mem_size = <0x00800000 0x4000000 0x100000>;
	4k2k_fb = <1>;
	logo_addr = "0x3e800000";
	mem_alloc = <0>;
	pxp_mode = <0>; /** 0:normal mode 1:pxp mode */
};

&drm_vpu {
	status = "okay";
	logo_addr = "0x3e800000";

	connectors_dev: port@1 {
		drm_to_lcd0: endpoint@0 {
			reg = <0>;
			remote-endpoint = <&lcd0_to_drm>;
		};
	};
};

&lcd {
	ports {
		port {
			#address-cells = <1>;
			#size-cells = <0>;
			lcd0_to_drm: endpoint@0 {
				reg = <0>;
				remote-endpoint = <&drm_to_lcd0>;
			};
		};
	};
};

&amhdmitx {
	status = "disabled";
	pxp_mode = <1>; /* run on pxp */
};

/*if you want to use vdin just modify status to "ok"*/
&vdin0 {
	/*memory-region = <&vdin0_cma_reserved>;*/
	status = "okay";
	/*MByte, if 10bit disable: 64M(YUV422),
	 *if 10bit enable: 64*1.5 = 96M(YUV422)
	 *if support 4K2K-YUV444-10bit-WR:3840*2160*4*4 ~= 128M
	 *if support 4K2K-YUV422-10bit-wr:3840*2160*3*4 ~= 96M
	 *if support 4K2K-YUV422-8BIT-WR:3840*2160*2*4 ~= 64M
	 *if support 1080p-YUV422-8BIT-WR:1920*1080*2*4 ~= 16M
	 * onebuffer:
	 * worst case:(4096*2160*3 + 2M(afbce issue)) = 27.5M
	 * dw:960x540x3 = 1.5M
	 * total size:(27.5+1.5)x buffernumber
	 */
	cma_size = <300>;
	frame_buff_num = <10>;
};

&vdin1 {
	memory-region = <&vdin1_cma_reserved>;
	status = "okay";
};

&periphs_pinctrl {
	pdmin: pdmin {
		mux { /* GPIOH_19, GPIOH_18,GPIOH_14*/
			groups = "pdm_dclk_h19",
					"pdm_din0_h18",
					"pdm_din1_h14";
			function = "pdm";
		};
	};
	tdm_b_pins: tdm_b_pin {
		mux { /* GPIOH15, GPIOH_16, GPIOH_17 */
			groups = "tdm_fs1_h15",
				"tdm_sclk1_h",
				"tdm_d0_h";
			function = "tdm";
		};
	};
	tdmout_a_gpio: tdmout_a_gpio {
		mux { /* GPIOH_15, GPIOH_16, GPIOH_17 */
			groups ="GPIOH_15",
				"GPIOH_16",
				"GPIOH_17";
			function = "gpio_periphs";
			output-low;
		};
	};
	dvb_s_ts0_pins: dvb_s_ts0_pins {
		tsin_a {
			groups = "tsin_a_sop",
				   "tsin_a_valid",
				   "tsin_a_clk",
				   "tsin_a_din0";
			function = "tsin_a";
		};
	};

	dvb_p_ts1_pins: dvb_p_ts1_pins {
		tsin_b {
			groups = "tsin_b_sop",
				   "tsin_b_valid",
				   "tsin_b_clk",
				   "tsin_b_d0",
				   "tsin_b_d1",
				   "tsin_b_d2",
				   "tsin_b_d3",
				   "tsin_b_d4",
				   "tsin_b_d5",
				   "tsin_b_d6",
				   "tsin_b_d7";
			function = "tsin_b";
		};
	};

	dvb_p_ts2_pins: dvb_p_ts2_pins {
		tsin_c {
			groups =   "tsin_c_sop_c",
				   "tsin_c_valid_c",
				   "tsin_c_clk_c",
				   "tsin_c_d0_c";
			function = "tsin_c";
		};
	};

	dvb_ci_bus_pins_all: dvb_ci_bus_pins_all {
		mux {
			groups = "cicam_cen", "cicam_oen",
				"cicam_wen", "cicam_iordn",
				"cicam_iowrn", "cicam_reset",
				"cicam_a0", "cicam_a1", "cicam_a2_c",
				"cicam_a3_c", "cicam_a4_c", "cicam_a5_c",
				"cicam_a6_c", "cicam_a7_c", "cicam_a8_c",
				"cicam_a9_c", "cicam_a10_c", "cicam_a11_c",
				"cicam_data0", "cicam_data1", "cicam_data2",
				"cicam_data3", "cicam_data4", "cicam_data5",
				"cicam_data6", "cicam_data7";
			function = "cicam";
		};
	};

	ci_ts_pins: ci_ts_pins {
		mux {
			groups = "tsout_sop", "tsout_valid",
				"tsout_d0", "tsout_d1", "tsout_d2",
				"tsout_d3", "tsout_d4", "tsout_d5",
				"tsout_d6", "tsout_d7";
			function = "tsout";
		};
	};

	ci_ts_clk_pins: ci_ts_clk_pins {
		mux {
			groups = "tsout_clk";
			function = "tsout";
		};

	};

	/*backlight*/
	bl_pwm_vs_on_pins:bl_pwm_vs_on_pin {
		mux {
			groups = "pwm_vs_h12";
			function = "pwm_vs";
		};
	};
	bl_pwm_off_pins:bl_pwm_off_pin {
		mux {
			groups = "GPIOH_12";
			function = "gpio_periphs";
			output-low;
		};
	};
	ST6451D06_3_pins: ST6451D06_3_pin {
		mux {
			groups = "tcon_1","tcon_2","tcon_3",
				"tcon_4","tcon_5","tcon_6",
				"tcon_9","tcon_10","tcon_11",
				"tcon_14", "tcon_lock";
			function = "tcon";
		};
	};
	ST6451D06_3_off_pins: ST6451D06_3_off_pin {
		mux {
			groups = "GPIOH_1","GPIOH_2","GPIOH_3",
				"GPIOH_4","GPIOH_5","GPIOH_6",
				"GPIOH_9","GPIOH_10","GPIOH_11",
				"GPIOH_14", "GPIOH_0";
				function = "gpio_periphs";
			input-enable;
		};
	};
	ST5461D18_2_pins: ST5461D18_2_pin {
		mux {
			groups = "tcon_1","tcon_2","tcon_3",
				"tcon_4","tcon_5","tcon_6",
				"tcon_9","tcon_10","tcon_11",
				"tcon_14","tcon_lock";
			function = "tcon";
		};
	};
	ST5461D18_2_off_pins: ST5461D18_2_off_pin {
		mux {
			groups = "GPIOH_1","GPIOH_2","GPIOH_3",
				"GPIOH_4","GPIOH_5","GPIOH_6",
				"GPIOH_9","GPIOH_10","GPIOH_11",
				"GPIOH_14","GPIOH_0";
				function = "gpio_periphs";
			input-enable;
		};
	};
};

&pinctrl_audio {
	tdm_d0_pins: tdm_d0_pin {
		mux {
			groups = "tdm_d0";
			function = "tdmoutb_lane0";
		};
	};
	tdmb_clk_pins: tdmb_clk_pin {
		mux {
			groups = "tdm_sclk0", "tdm_lrclk0";
			function = "tdm_clk_outb";
		};
	};
};

&i2c0 {
	status = "okay";
	clock-frequency = <300000>;
	pinctrl-names="default";
	pinctrl-0=<&i2c0_pins1>;
};

&amlvecm {
	status = "disabled";
	gamma_en = <0>;/*1:enable ;0:disable*/
	wb_en = <0>;/*1:enable ;0:disable*/
	cm_en = <0>;/*1:enable ;0:disable*/
	wb_sel = <0>;/*1:mtx ;0:gainoff*/
	vlock_en = <0>;/*1:enable;0:disable*/
	vlock_mode = <0x8>;
	/*vlock work mode:
	 *bit0:auto ENC
	 *bit1:auto PLL
	 *bit2:manual PLL
	 *bit3:manual ENC
	 *bit4:manual soft ENC
	 *bit5:manual MIX PLL ENC
	 */
	 vlock_pll_m_limit = <1>;
	 vlock_line_limit = <2>;
};

&aml_wifi{
	status = "okay";
	//interrupt-gpios = <&gpio  GPIOX_7  GPIO_ACTIVE_HIGH>;
	power_on-gpios = <&gpio   GPIOD_11  GPIO_ACTIVE_HIGH>;
};

&aml_bt {
	status = "okay";
	reset-gpios = <&gpio    GPIOD_13 GPIO_ACTIVE_HIGH>;
	/*hostwake-gpios = <&gpio GPIOX_19 GPIO_ACTIVE_HIGH>;*/
};

&irblaster {
	status = "disabled";
};

&uart_B {
	status = "okay";
};

&vddcpua {
	status = "okay";
};

&vddcpub {
	status = "okay";
};

&pwm_cd {
	status = "okay";
};

&dmx_aucpu {
	status = "okay";
};
